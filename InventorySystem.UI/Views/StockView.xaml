<UserControl x:Class="InventorySystem.UI.Views.StockView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" Background="White" BorderBrush="#E0E0E0" BorderThickness="0,0,1,0" Padding="15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Margin="0,0,0,15">
                    <TextBlock Text="Find Product" FontSize="18" FontWeight="Bold" Foreground="#2B3649" Margin="0,0,0,10"/>
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                             Padding="10" FontSize="14" ToolTip="Type product name..."/>
                </StackPanel>

                <DataGrid Grid.Row="1" ItemsSource="{Binding FilteredProducts}" SelectedItem="{Binding SelectedProduct}"
                          AutoGenerateColumns="False" IsReadOnly="True" BorderThickness="0" Background="White">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Product Name" Binding="{Binding Name}" Width="*"/>
                        <DataGridTextColumn Header="Current Stock" Binding="{Binding Quantity}" Width="90" FontWeight="Bold"/>
                    </DataGrid.Columns>
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Cursor" Value="Hand"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#E0F2F1"/>
                                    <Setter Property="Foreground" Value="#009688"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                </DataGrid>
            </Grid>
        </Border>

        <Grid Grid.Column="1" Background="#F9F9F9" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="0" Margin="0,0,0,20">
                <TextBlock Text="Selected Item:" Foreground="Gray" FontSize="12"/>
                <TextBlock Text="{Binding SelectedProduct.Name, TargetNullValue='(Select a product on the left)'}" 
                           FontSize="24" FontWeight="Bold" Foreground="#2B3649"/>
            </StackPanel>

            <TabControl Grid.Row="1" Height="300" Background="Transparent" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="FontSize" Value="14"/>
                        <Setter Property="Padding" Value="15,10"/>
                        <Setter Property="Cursor" Value="Hand"/>
                    </Style>
                </TabControl.Resources>

                <TabItem Header="📦 Receive Stock (IN)">
                    <Border Background="White" CornerRadius="5" Padding="20" BorderBrush="#E0E0E0" BorderThickness="1">
                        <StackPanel>
                            <StackPanel.Style>
                                <Style TargetType="StackPanel">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SelectedProduct}" Value="{x:Null}">
                                            <Setter Property="IsEnabled" Value="False"/>
                                            <Setter Property="Opacity" Value="0.5"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </StackPanel.Style>
                            <TextBlock Text="Quantity to Add" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <TextBox Text="{Binding Quantity}" Padding="10" FontSize="16" Margin="0,0,0,15"/>

                            <TextBlock Text="New Cost Price (Per Item)" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <TextBox Text="{Binding CostPrice}" Padding="10" FontSize="16" Margin="0,0,0,15"/>

                            <Button Content="CONFIRM STOCK IN" Command="{Binding ReceiveStockCommand}" 
                                    Height="50" Background="#009688" FontSize="14" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Border>
                </TabItem>

                <TabItem Header="⚠️ Adjustment (OUT)">
                    <Border Background="White" CornerRadius="5" Padding="20" BorderBrush="#E0E0E0" BorderThickness="1">
                        <StackPanel>
                            <TextBlock Text="Quantity to Remove" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <TextBox Text="{Binding AdjustmentQty}" Padding="10" FontSize="16" Margin="0,0,0,15"/>

                            <TextBlock Text="Reason" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <ComboBox ItemsSource="{Binding AdjustmentReasons}" SelectedItem="{Binding AdjustmentReason}" 
                                      Padding="10" Height="40" Margin="0,0,0,15"/>

                            <Button Content="CONFIRM REMOVAL" Command="{Binding AdjustStockCommand}" 
                                    Height="50" Background="#E74C3C" FontSize="14" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Border>
                </TabItem>
            </TabControl>

            <Grid Grid.Row="2" Margin="0,20,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock Text="Recent Activity Log" FontWeight="Bold" Foreground="#555" Margin="0,0,0,10"/>

                <DataGrid Grid.Row="1" ItemsSource="{Binding RecentHistory}" AutoGenerateColumns="False" IsReadOnly="True" 
                          Background="White" BorderThickness="0" HeadersVisibility="Column">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat='dd MMM HH:mm'}" Width="120"/>
                        <DataGridTextColumn Header="Product" Binding="{Binding Product.Name}" Width="*"/>
                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="80"/>
                        <DataGridTextColumn Header="Qty" Binding="{Binding Quantity}" Width="60" FontWeight="Bold"/>
                        <DataGridTextColumn Header="Note" Binding="{Binding Note}" Width="150"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Grid>
    </Grid>
</UserControl>